---
title: "Itkonen Structures 50 Years On"
author:
  - Madelaine O'Reilly-Brown^1^
  - Brandon Papineau^1^
  # - Arto Anttila^1^
  # - Paul Kiparsky^1^
  - ^1^*Stanford University*
date: "`r format(Sys.time(), '%d %B, %Y')`"
output:
  html_document:
      toc: true
      toc_float: true
---

<!-- This bit above is kind of similar to a LaTeX preamble, except that libraries (packages) get loaded in the actual code, rather than up here: -->

```{css, echo=FALSE}
.list-group-item.active {
  background-color: rgb(140, 21, 21);
}

.list-group-item.active:hover {
  background-color: rgb(140, 21, 21);
}

.list-group-item:hover {
  background-color: rgb(140, 21, 21);
  color: rgb(255,255,255)
}

h1 {
  color: rgb(140, 21, 21);
}

a:focus{
  color: rgb(140, 21, 21);
}

a {
  color: rgb(140, 21, 21);
}

a:hover {
  color: #820000;
}
```

<!-- SETTING UP THE DATA: COMMENTED INSTRUCTIONS-->

```{r include=FALSE}

#This chode chunk loads the 4 libraries needed for the analysis and visualization

library(tidyverse) #Tidy data, ggplot2, etc.
library(mlogit) #logit function, for multinomial analyses
library(lme4,lmertest) #for mixed logistic binomial regressions
library(formattable,DT) # Prettier tables
library(rmdformats) # For the custom html output
library(shiny) # interactive tabls


# Here's some custom visual styling stuff

bran_palette = c("#7ae7e5", "#fe5f55", "#B2A6DE", "#14342b", "#69385c") 
voice_palette = c("#DB995A","#654236") #Defines a custom color palette we can use in ggplot graphs; stored as a list of hex codes
type_palette = c("#7EBDC2","#DA7635")

# FAA6FF Additional HEX 

# "#81b29a","f2cc8f"

theme_set(theme_bw()) #Sets the defaut theme of all ggplot objects to black & white

customGreen = "#71CA97" #Another custom green for the formattable tables
```

```{r include=FALSE}
source("helpers.R")
```


```{r echo=FALSE}
# I'm also importing a custom function from [https://mikeyharper.uk/about/] which allows us to collapse table rows when they have the same values 

# Collapse the values within a grouped dataframe
collapse_rows_df <- function(df, variable){

  group_var <- enquo(variable)

  df %>%
    group_by(!! group_var) %>%
    mutate(groupRow = 1:n()) %>%
    ungroup() %>%
    mutate(!!quo_name(group_var) := ifelse(groupRow == 1, as.character(!! group_var), "")) %>%
    select(-c(groupRow))
}
```

<!-- Now we can read-in the experiment-generated csv. We also want to filter out the training trials (where choice == "True"), and rename the subject_information.demogrpahic columns to be more usable. While we do that, we will also make sure they get read into the data frame as factors, rather than characters. -->

```{r echo=FALSE}
itkonen <- read.csv("itkonen-rep.csv") %>% 
  filter(choice != "True") %>% 
  mutate(comments = subject_information.comments,
         age = as.numeric(subject_information.age),
         gender = as.factor(subject_information.gender),
         region = as.factor(subject_information.region),
         education = as.numeric(subject_information.education)) %>% 
  select(-c("subject_information.gender","subject_information.comments","subject_information.age","subject_information.region","subject_information.education"))
```

<!-- We also want to read in the by-item proportions from Itkonen's original study: -->

```{r echo=FALSE}
itkonenOriginal <- read.csv("itkonen-original.csv")
```

<!-- ### Set Response Cases -->

<!-- This code creates the 4 bins of responses we have. The first three are lists of the different cases' realizations in the critical items. The last is the same, but will let us code for attention checks. -->

```{r echo=FALSE}
nomForms = c("kappalainen","harvinainen erikoistapaus","valtio valtiossa","persikka","tulipalo","jokin maininta","mikään maininta","persoonallinen suhde"," kappalainen")
```

```{r echo=FALSE}
genForms = c("kappalaisen","harvinaisen erikoistapauksen","valtion valtiossa","persikan","tulipalon","jonkin maininnan","minkään maininnan","persoonallisen suhteen")
```

```{r echo=FALSE}
partForms = c("kappalaista","harvinaista erikoistapausta","valtiota valtiossa","persikkaa","tulipaloa","mitään mainintaa","persoonallista suhdetta")
```

```{r echo=FALSE}
attForms = c("on","olet","olen")
```

<!-- ### Mutate to add Response Case for each trial -->

<!-- With that done, we can actually code all the responses in the whole new data frame for their case response, coded as responseCase -->

```{r echo=FALSE}
itkonen <- itkonen %>% 
  mutate("responseCase" = case_when(
    response %in% nomForms ~ "nom", #if the reponse case is available in the above-defined nominative list, create a new column with the value "nom" for that trial
    response %in% genForms ~ "gen", # ... and the same for genitive and partitive, as well as attention
    response %in% partForms ~ "part",
    response %in% attForms ~ "attn",
    TRUE ~ "uncoded"
  ))
```

<!-- ## Exclusions -->

<!-- *Generate Exclusion List* -->

<!-- This code allows us to create an exclusion list, or a list of all participants who didn't score 100% on our three attention checks.  -->

```{r echo=FALSE}
exclusionList <- itkonen %>% 
  filter(responseCase == "attn") %>% # Take only the attention trials
  group_by(workerid) %>% # Group the data frame by each participant
  summarise(accuracy = mean(as.numeric(attention))) %>% # For each participant, calculate a score between 0-1, the mean of their attention checks; 1 = passed attention check, 0 = failed attention check
  mutate(exclude = ifelse(accuracy < 1,'Yes','No')) %>% #If that mean is anything lower than 1 (perfect attention), we want to give them the characteristic "EXCLUDE=TRUE"
  filter(exclude == "Yes") #Now filter out all the people who passed, so we get a list of the people who failed only
```

<!-- *Run Exclusion Filter* -->

```{r echo=FALSE}
itkonen <- itkonen[!(itkonen$workerid %in% exclusionList$workerid),] #Now remove from the full dataframe all the participants who are listed on the list we just created
```

# Introduction

The issue of object case assignment in Finnish is one of longstanding interest to linguists due to the complex interaction of semantic and syntactic variables involved. While significant steps have been made towards characterizing object case assignment in the language, there are two constructions, commonly referred to as “Itkonen structures” and “Ikola structures”, which resist neat categorization within the accounts that have been proposed so far due to the fact that the case appearing on their embedded object appears to be in free variation between nominative and genitive. Itkonen structures, which will be the focus of this study, were first identified in Itkonen (1976), an experimental study of case variation in complex clauses. Itkonen claimed that genitive case was gradually being replaced by nominative case, and that the case variation observed in Itkonen structures resulted from analogy from changes occurring in case assignment preferences in certain matrix clause configurations. This predicts not only that nominative case should appear on embedded objects of Itkonen at a higher rate under diachronic examination, but also that this change should diffuse across Itkonen structures in a variety of contexts in a predictable manner, with those constructions bearing the most similarity to the analogous simplex clauses having progressed the furthest.

With regard to the mechanisms which derive the variation in case assignment, one strand of thought which appears frequently in minimalist accounts holds that this phenomenon is the result of a structural ambiguity (Vainikka & Brattico 2014, Ylinärä & Frascarelli, 2021). While the specifics of the claims vary, typically these accounts argue that there are two available structures, one in which the embedded clause is capable of assigning the object case itself, and one which involves a reduced clausal structure resulting in object case assignment by some matrix element. Given that, one might expect a difference with respect to certain biclausality diagnostics in speakers who prefer nominative or genitive case.

In order to test the predictions made in Itkonen (1976), as well as the claims of minimalist accounts which argue that case variation results from structural ambiguity, we created an experimental study consisting of two parts. The first section is an exact replication of the study in Itkonen (1976), in which participants were asked to fill in the blank with an embedded object with the case of their choice, while the second portion asks participants to perform an identical task, except with a subsection of the original Itkonen (1976) stimuli which are altered so that there is negation in the matrix clause. Traditionally, the embedded objects of negated Itkonen constructions would bear partitive case, and we aimed to see whether case assignment in those constructions is subject to variation as well.

The results of our study show that nominative case appears at much higher frequencies now in comparison to the original Itkonen (1976) study, supporting his claim that the case variation he observed was the result of a change in progress away from a preference for genitive case on embedded case and towards a preference for nominative case. Additionally, we found that embedded objects of negated Itkonen structures are assigned nominative case just under 20% of the time, suggesting that the preference for nominative case is spreading beyond traditional genitive strongholds and into contexts which were not previously thought to be subject to this change. 
	

## Background

Objects in Finnish can appear in one of four cases: partitive, accusative, genitive, and nominative. The only cases which appear in free variation on embedded objects of Itkonen structures are nominative and genitive, hence they will be the focus of this study. Itkonen structures are nonfinite propositional complements headed by participle forms of verbs including ‘say’ and ‘think’ (Vainikka & Brattico, 2014):


At the time of the Itkonen (1976) study, not all Itkonen structures were equal when it came to the case assigned to the embedded object. Rather, the distribution of nominative and accusative case on embedded objects was influenced by both the voice of the matrix clause and the type of embedded verb, summarized below:

- Matrix verb active, embedded clause transitive: GEN
- Matrix verb passive, embedded clause transitive: NOM ~ GEN
- Matrix verb active, embedded clause existential: GEN preferred
- Matrix verb passive, embedded clause existential: NOM preferred
- Matrix verb active, embedded clause predicative: NOM preferred
- Matrix verb passive, embedded clause predicative: NOM strongly preferred

Itkonen (1976) argued that genitive case was the historically dominant form, while nominative case was in the process of replacing genitive due to analogy to simplex clauses. His study found that nominative was more common under passives than under actives, and more common in predicatives than existentials. In their Optimality Theoretic account of object case variation, Vainikka & Brattico (2014) argue that the genitive-to-nominative shift began in predicative and passive matrix clauses, and is now proceeding through existential and active matrix clauses. That claim taken together with Itkonen (1976) makes the clear prediction that, in the results of our replication study and in comparison to the 1976 findings, we should find that: (1) the nominative will consistently appear at higher frequencies on the embedded object of Itkonen structures, and (2), if there is still variation in case assignment, we should observe the rate of nominative case increase from matrix active, embedded existential contexts to matrix passive, embedded predicative contexts.

The second portion of our experiment concerns case assignment under negation. It is a general fact of Finnish that object DPs under the scope of negation receive partitive case (Vainikka & Brattico, 2014). Minimalist accounts of the Finnish free-variation case assignment phenomenon have generally attempted to derive it by arguing that it derives from distinct structures with differing levels of independence from the matrix clause, meaning that the object of the less independent clause receives case from some matrix element, while the object of the more independent clause receives case clause-internally. For example, Vainikka & Brattico (2014) argue that certain embedded clauses can optionally include an AgrP which is capable of assigning genitive case, while Ylinärä & Frascarelli (2020) argue that variation derives from ambiguity between verbal and nominalized structures, with the embedded argument of the nominalization actually being a subject which receives genitive case. Interestingly, those two accounts make opposite claims as to which case type correlates with which (more or less independent) embedded clause type. If it is indeed the case that the choice of case on the embedded object correlates with different structural configurations, in which the embedded object can be assigned case by a matrix or embedded element, and additionally that speakers are consistent as to which of those two structures they employ (this is shown to be the case in Itkonen (1976), in which speakers were consistent in preferring either genitive or nominative case), then we may expect differences in object case under negation. For example, if a speaker opts for the structure in which the embedded clause is able to assign case to its embedded object, we might expect the embedded object not to receive partitive case when the matrix clause is negated. On the other hand, if the embedded object receives case from the matrix clause, we might expect it occur with partitive case. Furthermore, we anticipate that a speaker’s preference in non-negated contexts will correlate with their preference in negated contexts.


## Itkonen's Original Results 

Before continuing, it's worth noting Itkonen's original results, which he published in 1976.

```{r echo=FALSE, message=FALSE}
itkonenOriginal %>%
  mutate(itemNomRateOriginal = 100*itemNomRateOriginal) %>% 
  rename("Item" = item,
         "Voice" = voice,
         "Type" = type,
         "Rate of Nominative (x/100)" = itemNomRateOriginal) %>% 
  select(-c("itemGenRateOriginal")) %>% 
  group_by(Item) %>%
  slice(1:4) %>% 
  select(Item, everything()) %>%
  collapse_rows_df(Item) %>%
  formattable(align=c("l"), list(
  area(col = "Rate of Nominative (x/100)") ~ color_tile("transparent", customGreen))) %>% 
  as.datatable(escape = FALSE,
               options = list(scrollX = TRUE,
                              pageLength = 100),
               rownames = FALSE)
```

# Methods

## Participants
We used Itkonen's orignal sample size (n=126) as a benchmark for how many participants to recruit. Ultimately, 117 participants were recruited through the online recruitment platform [Prolific](https://Prolfic.co), all of whom self-identified as fluent and native speakers of Finnish. Participants were paid $2 for their participation in the study. 

## Stimuli 
The first 22 trials of the study contained stimuli identical to that of Itkonen (1976). There were 7 stimulus frames, of which 4 appeared in all 4 possible voice & structure combinations: 

- Active-Existential
- Active-Predicative
- Passive-Existential
- Passive-Predicative

The remaining 3 stimulus frames occurred only in the existential forms.

In the second half of the study, we added 15 negated sentences, which are predicted to only allow the partitive. The inclusion of these items was meant to investigate whether some speakers permit or produce the nominative or genitive, possibly by way of extension from the positive phrases. 

We additionally included two re-formulated versions of the 'jokin' stimulus item, due to Itkonen's original wording being judged as non-standard by the third author.

Finally, we included three attention check items in the second half of the study, all of which asked participants to inflect the copular verb for different persons. 

All modifications to the study (negated sentences, 'jokin' restructures, and attention checks) were included in the second half so as to be as faithful to Itkonen's original study as possible.


## Procedure
After providing informed consent, participants were instructed that they would be reading 40 sentences which needed to be completed, and that they should select one of the options provided to best complete the sentence. They then completed an example trial with a prescriptively correct answer, on the basis of verb inflection.

After this, participants proceeded through the 40 trials, selecting one of two or three presented options to complete the sentence. The first 22 replicated Itkonen's original study; items in this chunk were randomized between participants, and the order of options provided were also randomized. The last 18 items, which deviated from and added on to Itkonen's study, were similarly randomized. 

After completing the main study, participants were presented with a demographic questionnaire, which asked about age, education, gender, and county of Finland from which the participant came. All questions were optional.

A link to the experiment can be found [here](https://branpap.github.io/itkonen-replication/experiment/experiment.html). This version does **not** record responses, and is for demonstration purposes only.

# Results

```{r echo=FALSE}
ReplicationOnly <- itkonen %>% 
  filter(polarity == "positive") %>% 
  filter(item != "jokin2") %>% 
  mutate(responseBinary = case_when(
    responseCase == "nom" ~ 1,
    TRUE ~ 0
  ))
```

```{r include=FALSE}
replicationItems <- ReplicationOnly %>% 
  group_by(item,voice,type,responseCase) %>% 
  count() %>% 
  pivot_wider(names_from = responseCase,values_from = n) %>% 
  replace_na(list(gen=0)) %>% 
  summarize(itemNomRate = nom/(nom+gen),
            itemGenRate = 1-itemNomRate)
```

```{r include=FALSE}
compItems <- left_join(itkonenOriginal,replicationItems) 
```

```{r echo=FALSE}
compItems <- compItems %>% 
  mutate(itemNomRate = trunc(itemNomRate*10^2),
         itemGenRate = trunc(itemGenRate*10^2),
         itemNomRateOriginal = trunc(itemNomRateOriginal*10^2),
         itemGenRateOriginal = trunc(itemGenRateOriginal*10^2),
         nomChange = itemNomRate - itemNomRateOriginal) %>% 
  select(-c("itemGenRate","itemGenRateOriginal")) 
```

## Replication Study: In Isolation {.tabset}

In our faithful replication of Itkonen's original study, we find similar patterns to those in the original study, with regard to voice, structure, and item effects. We take each of these in turn here, which can be navigated to by clicking on the respective tabs below. 

*Model Structure*

We fit a logistic mixed effects model which predicted nominative responses from fixed effects of voice (binary, reference level: "active"), structure type (binary, reference level:"existential"), and age (continuous). Finally, we included random intercepts for participant and lexical item. 

```{r include=FALSE}
ReplicationOnly <- ReplicationOnly %>% 
  mutate(type = factor(type,ordered = FALSE)) %>%
  mutate(voice = factor(voice,ordered = FALSE)) 
```

```{r include=FALSE}
ReplicationOnly$type = relevel(ReplicationOnly$type, ref="existential")
ReplicationOnly$voice = relevel(ReplicationOnly$voice, ref="active")
```

```{r include=FALSE}
full_model = glmer(as.factor(responseBinary)~voice*type + age + (1|workerid) + (1|item),data=ReplicationOnly,family="binomial")
```

```{r include=FALSE}
summary(full_model)
```


### Voice

Just as in Itkonen (1976), we found a significant main effect of voice, such that passive sentences were more likely to be completed by a nominative DP than their active counterparts (p<.001). Passive sentences received nominative completion choices 91% of the time, compared to 78% of the time for active sentences.

```{r echo=FALSE, fig.align = 'center'}
ReplicationOnly %>% 
  mutate(responseBinary = case_when(
    responseCase == "nom" ~ 1,
    responseCase == "gen" ~ 0,
  )) %>% 
  group_by(voice) %>% 
  summarize(
    nomRate = mean(responseBinary),
    CI.Low = ci.low(responseBinary),
    CI.High = ci.high(responseBinary),
  ) %>% 
  mutate(YMin = nomRate - CI.Low, YMax = nomRate + CI.High) %>%
  ggplot(aes(x=voice,y=nomRate, fill=voice)) + 
  geom_bar(stat="identity") + 
  geom_errorbar(aes(ymin=YMin,ymax=YMax), width=.25) + 
  geom_hline(yintercept=.5, linetype="dashed", color = "black") + 
  labs(x="Voice",y="Proportion of Nominative Responses",title="Replication Results: Voice") + 
  ylim(0,1) + 
  geom_text(aes(x=voice,y=nomRate, vjust =-2, label=trunc(nomRate*10^2)/(10^2))) + 
  scale_fill_manual(values=voice_palette) + 
  theme_classic() +
  theme(legend.position = "none") 
```

### Structure

We also found, as Itkonen (1976) did, a significant main effect of structure type, such that predicative sentences were more likely to be completed by a nominative DP than their existential counterparts (p<.001). Predicative sentences received nominative completion choices 96% of the time, compared to 78% of the time for existential sentences.

```{r echo=FALSE, fig.align = 'center'}
ReplicationOnly %>% 
  mutate(responseBinary = case_when(
    responseCase == "nom" ~ 1,
    responseCase == "gen" ~ 0,
  )) %>% 
  group_by(type) %>% 
  summarize(
    nomRate = mean(responseBinary),
    CI.Low = ci.low(responseBinary),
    CI.High = ci.high(responseBinary),
  ) %>% 
  mutate(YMin = nomRate - CI.Low, YMax = nomRate + CI.High) %>%
  ggplot(aes(x=type,y=nomRate, fill=type)) + 
  geom_bar(stat="identity") + 
  geom_errorbar(aes(ymin=YMin,ymax=YMax), width=.25) + 
  geom_hline(yintercept=.5, linetype="dashed", color = "black") + 
  labs(x="Voice",y="Proportion of Nominative Responses",title="Replication Results: Voice") + 
  ylim(0,1) + 
  geom_text(aes(x=type,y=nomRate, vjust =-1.5, label=trunc(nomRate*10^2)/10^2)) + 
  scale_fill_manual(values = type_palette) + 
  theme_classic() + 
  theme(legend.position = "none") 
```

### Crossed Voice x Structure

```{r echo=FALSE, message=FALSE, fig.align = 'center'}
ReplicationOnly %>% 
  mutate(responseBinary = case_when(
    responseCase == "nom" ~ 1,
    responseCase == "gen" ~ 0,
  )) %>% 
  group_by(type,voice) %>% 
  summarize(
    nomRate = mean(responseBinary),
    CI.Low = ci.low(responseBinary),
    CI.High = ci.high(responseBinary),
  ) %>% 
  mutate(YMin = nomRate - CI.Low, YMax = nomRate + CI.High) %>%
  ggplot(aes(x=reorder(type, nomRate),y=nomRate, fill=type)) + 
  geom_bar(stat="identity") + 
  geom_errorbar(aes(ymin=YMin,ymax=YMax), width=.25) + 
  geom_text(aes(x=type,y=nomRate, vjust =-1.3, label=trunc(nomRate*10^2)/10^2)) +
  labs(x="Item", y="Proportion of Nominative Responses", title="Nominative Rates of Replication Items: Voice x Structure") + 
  scale_fill_manual(values=type_palette) + 
  facet_wrap(~voice) + 
  theme_classic() +
  ylim(0,1) + 
  theme(legend.position = "none") 
```

### Items

```{r echo=FALSE, fig.align = 'center'}
ReplicationOnly %>% 
  filter(voice=="active") %>% 
  mutate(responseBinary = case_when(
    responseCase == "nom" ~ 1,
    responseCase == "gen" ~ 0,
  )) %>% 
  group_by(item) %>% 
  summarize(
    nomRate = mean(responseBinary),
    CI.Low = ci.low(responseBinary),
    CI.High = ci.high(responseBinary),
  ) %>% 
  mutate(YMin = nomRate - CI.Low, YMax = nomRate + CI.High) %>%
  ggplot(aes(x=reorder(item, -nomRate),y=nomRate, fill=item)) + 
  geom_bar(stat="identity") + 
  geom_errorbar(aes(ymin=YMin,ymax=YMax), width=.25) + 
  geom_text(aes(x=item,y=nomRate, vjust =4, label=trunc(nomRate*10^2)/10^2)) +
  geom_hline(yintercept=.5, linetype="dashed", color = "black") + 
  labs(x="Item", y="Proportion of Nominative Responses", title="Nominative Rates of Replication Items: Active Only") + 
  scale_fill_brewer(palette="Paired") +
  theme_classic() +
  ylim(0,1) + 
  theme(legend.position = "none")
```


```{r, echo=FALSE, fig.align = 'center'}
ReplicationOnly %>% 
  filter(voice=="passive") %>% 
  mutate(responseBinary = case_when(
    responseCase == "nom" ~ 1,
    responseCase == "gen" ~ 0,
  )) %>% 
  group_by(item) %>% 
  summarize(
    nomRate = mean(responseBinary),
    CI.Low = ci.low(responseBinary),
    CI.High = ci.high(responseBinary),
  ) %>% 
  mutate(YMin = nomRate - CI.Low, YMax = nomRate + CI.High) %>%
  ggplot(aes(x=reorder(item, -nomRate),y=nomRate, fill=item)) + 
  geom_bar(stat="identity") + 
  geom_errorbar(aes(ymin=YMin,ymax=YMax), width=.25) + 
  geom_text(aes(x=item,y=nomRate, vjust =4, label=trunc(nomRate*10^2)/10^2)) +
  geom_hline(yintercept=.5, linetype="dashed", color = "black") + 
  labs(x="Item", y="Proportion of Nominative Responses", title="Nominative Rates of Replication Items: Passive Only") + 
  scale_fill_brewer(palette="Paired") +
  theme_classic() +
  ylim(0,1) + 
  theme(legend.position = "none")
```

### Age

Finally, we found a main effect of age, such that the younger a participant was, the more likely they were to provide nominative responses (p<.01). Descriptively, it is worth noting that of the 11 participants who provided **only** nominative responses, only three were over the age of 30. Similarly, all three participants who provided genitive responses at least 50% of the time were over the age of 37. These findings, taken together, provide an apparent-time snapshot of the language that indicates a change in progress, whereby the genitive case is giving way to nominative in Itkonen structures.

```{r include=FALSE}
nomRates <- ReplicationOnly %>% 
  group_by(workerid,responseCase) %>% 
  count() %>% 
  pivot_wider(names_from = responseCase,values_from = n) %>% 
  summarize(NomRate = nom/22)
```

```{r include=FALSE}
ReplicationOnly <- left_join(ReplicationOnly,nomRates)
```

```{r echo=FALSE, message=FALSE, fig.align = 'center'}
ReplicationOnly %>% 
  filter(!is.na(age)) %>% 
#  filter(age < 60) %>% 
  ggplot(aes(x=age,y=NomRate)) + 
  geom_point() + 
  geom_smooth(method="lm") + 
  geom_hline(yintercept=.5, linetype="dashed", color = "black") + 
  labs(y="Proportion of Nominative Responses",title="Replication Results: Age") + 
  ylim(0,1) 
```


### Region

```{r echo=FALSE, fig.align = 'center'}
ReplicationOnly %>% 
  filter(region != "null") %>% 
  mutate(responseBinary = case_when(
    responseCase == "nom" ~ 1,
    responseCase == "gen" ~ 0,
  )) %>% 
  group_by(region) %>% 
  summarize(
    nomRate = mean(responseBinary),
    CI.Low = ci.low(responseBinary),
    CI.High = ci.high(responseBinary),
    count = as.numeric(n()),
  ) %>% 
  mutate(YMin = nomRate - CI.Low, YMax = nomRate + CI.High) %>%
  ggplot(aes(x=reorder(region,-nomRate),y=nomRate, alpha=count)) + 
  geom_bar(stat="identity") + 
  geom_errorbar(aes(ymin=YMin,ymax=YMax), width=.25) + 
  geom_hline(yintercept=.5, linetype="dashed", color = "black") + 
  labs(x="Voice",y="Proportion of Nominative Responses",title="Replication Results: Region") + 
  ylim(0,1) + 
  geom_text(aes(x=region,y=nomRate, vjust =-1.5, label=trunc(nomRate*10^2)/10^2)) + 
  theme_classic() + 
  theme(axis.text.x = element_text(angle=45, vjust = .5))
  
  #theme(legend.position = "none") 
```

<!-- *Education* -->

<!-- ```{r echo=FALSE, message=FALSE} -->
<!-- ReplicationOnly %>%  -->
<!--   filter(education != -1) %>%  -->
<!--   ggplot(aes(x=education,y=NomRate)) +  -->
<!--   geom_point() +  -->
<!--   geom_smooth(method = "lm") +  -->
<!--   labs(y="Rate of Nominative Produced",title="Replication Results: Age") -->
<!-- ``` -->

## Replication Study: Changes Over Time

Having now provided an overview of our findings, which largely pattern like those of Itkonen (1976), we turn to the issue of whether or not there are significant differences between our own results and Itkonen's. We indeed find the pattern which Itkonen himself predicted almost 50 years ago: for every single item and condition in our study, the proportion of nominative productions was larger than that of Itkonen's original study. Estimated means based on Itkonen's reported numbers (1976) are shown below in comparison with our own.

```{r echo=FALSE, message=FALSE}
replicationConditions <- ReplicationOnly %>% 
  group_by(voice,type) %>% 
  summarize(nomRate = mean(responseBinary),
            year = "2022")
```

```{r echo=FALSE,message=FALSE}
itkonenConditions <- itkonenOriginal %>% 
  group_by(voice,type) %>% 
  summarize(nomRate = mean(itemNomRateOriginal),
            year = "1976")
```

```{r include=FALSE}
compConditions <- rbind(itkonenConditions,replicationConditions)
```

```{r include=FALSE}
dodge = position_dodge(.9)
```


```{r echo=FALSE, fig.align = 'center'}
compConditions %>% 
  ggplot(aes(x=voice,y=nomRate,fill=year)) +
  geom_bar(stat="identity",position=position_dodge()) + 
  geom_text(aes(x=voice,y=nomRate,label=trunc(nomRate*10^2)/10^2),position=dodge) + 
  facet_wrap(~type) + 
  labs(x="Voice",y="Proportion of Nominative Responses",fill="Year")
```


Unfortunately, because we do not have access to Itkonen's original dataset, a frequentist model of the differences is impossible. However, our descriptive findings are such that we feel confident any modelling of the differences would lead to the same conclusions that we have just described. That is, there does appear to have been a significant change in the rates of nominative DPs occurring in these embedded object structures, such that the genitive case is being supplanted by the nominative diachronically. 

An item-by-item table is presented here for the curious reader.

```{r echo=FALSE, message=FALSE}
compItems %>% 
  rename("Item" = "item",
         "Voice" = "voice",
         "Structure" = "type",
         "Nominative Proportion (1976)" = "itemNomRateOriginal",
         "Nominative Proportion (2022)" = "itemNomRate",
         "Change (1976 -> 2022)" = "nomChange") %>% 
  formattable(align = c("l"), list(
  area(col = "Change (1976 -> 2022)") ~ color_tile("transparent", customGreen),
  area(col = "Nominative Proportion (2022)") ~ color_tile("transparent", "#e38f8f"),
  area(col = "Nominative Proportion (1976)") ~ color_tile("transparent", "#8fc4e3"))) %>% 
  as.datatable(escape = FALSE,
               options = list(scrollX = TRUE,
                              pageLength = 100),
               rownames = FALSE)
```


## New Items {.tabset}
As mentioned above, we additionally tested a handful of new critical items, specifically looking at case assignment in negated Itkonen structures. While participants provided partitive, nominative, and genitive responses under negation (as displayed in the table below), we were primarily interested in the potential presence of nominative case under negation, so visualizations reflect this (i.e. partitive and genitive responses are conflated). This also allows for easier interpretability and comparison with the replication results.

```{r echo=FALSE}
neg <- itkonen %>%
  filter(polarity == "negative") %>%
  filter(item != "jokin2")
```

<!-- # ```{r echo=FALSE, message=FALSE} -->
<!-- # neg %>%  -->
<!-- #   group_by(voice,responseCase) %>%  -->
<!-- #   count() %>%  -->
<!-- #   pivot_wider(values_from = n, names_from = responseCase) %>%  -->
<!-- #   rename(Voice = voice, Genitive = gen, Nominative = nom, Partitive = part) %>%  -->
<!-- #   formattable(align=c("l"), list( -->
<!-- #   area(row = 1, col=2:4) ~ color_tile("transparent", customGreen), -->
<!-- #   area(row = 2, col=2:4) ~ color_tile("transparent", customGreen))) -->
<!-- # ``` -->

### Case Assignment

We found that participants overwhelmingly preferred the partitive under negation, with approximately 80% of responses being Partitive in both active and passive sentences. However, a significant proportion of responses were Nominative (16%), and we recevied about 3% Genitive responses. These proportions are provided in the table below. The following figure provides proportions of Nominative responses in the two negation sentence voices.

```{r echo=FALSE, message=FALSE}
neg %>% 
  filter(responseCase != "uncoded") %>% # Bran remember to check this before presentation
  group_by(voice,responseCase) %>% 
  count() %>% 
  pivot_wider(values_from = n, names_from = responseCase) %>% 
  mutate(genRate = trunc(gen/(nom+gen+part)*10^2)/10^2,
         nomRate = trunc(nom/(nom+gen+part)*10^2)/10^2,
         partRate = trunc(part/(nom+gen+part)*10^2)/10^2) %>% 
  rename(Voice = voice, Genitive = genRate, Nominative = nomRate, Partitive = partRate) %>% 
  select(-c("nom","gen","part")) %>% 
  formattable(align=c("l"), list(
  area(row = 1, col=2:4) ~ color_tile("transparent", customGreen),
  area(row = 2, col=2:4) ~ color_tile("transparent", customGreen)))
```

```{r echo=FALSE, fig.align = 'center'}
neg %>% 
  mutate(responseBinary = case_when(
    responseCase == "nom" ~ 1,
    responseCase != "nom" ~ 0,
  )) %>% 
  group_by(voice) %>% 
  summarize(
    nomRate = mean(responseBinary),
    CI.Low = ci.low(responseBinary),
    CI.High = ci.high(responseBinary),
  ) %>% 
  mutate(YMin = nomRate - CI.Low, YMax = nomRate + CI.High) %>%
  ggplot(aes(x=voice,y=nomRate, fill=voice)) + 
  geom_bar(stat="identity") + 
  geom_errorbar(aes(ymin=YMin,ymax=YMax), width=.25) + 
  geom_hline(yintercept=.5, linetype="dashed", color = "black") + 
  labs(x="Voice",y="Proportion of Responses",title="Negative Results: Voice") + 
  ylim(0,1) + 
  geom_text(aes(x=voice,y=nomRate, vjust =-2, label=trunc(nomRate*10^2)/(10^2))) + 
  scale_fill_manual(values=voice_palette) + 
  theme_classic() +
  theme(legend.position = "none") 
```

<!-- ```{r echo=FALSE} -->
<!-- neg %>%  -->
<!--   mutate(responseBinary = case_when( -->
<!--     responseCase == "gen" ~ 1, -->
<!--     responseCase != "gen" ~ 0, -->
<!--   )) %>%  -->
<!--   group_by(voice) %>%  -->
<!--   summarize( -->
<!--     nomRate = mean(responseBinary), -->
<!--     CI.Low = ci.low(responseBinary), -->
<!--     CI.High = ci.high(responseBinary), -->
<!--   ) %>%  -->
<!--   mutate(YMin = nomRate - CI.Low, YMax = nomRate + CI.High) %>% -->
<!--   ggplot(aes(x=voice,y=nomRate, fill=voice)) +  -->
<!--   geom_bar(stat="identity") +  -->
<!--   geom_errorbar(aes(ymin=YMin,ymax=YMax), width=.25) +  -->
<!--   labs(x="Voice",y="Proportion of Responses",title="Replication Results: Voice") +  -->
<!--   ylim(0,1) +  -->
<!--   geom_text(aes(x=voice,y=nomRate, vjust =-1.5, label=trunc(nomRate*10^2)/10^2)) +  -->
<!--   scale_fill_manual(values = type_palette) +  -->
<!--   theme_classic() +  -->
<!--   theme(legend.position = "none")  -->
<!-- ``` -->

<!-- ## Gen Users -->

<!-- ```{r} -->
<!-- genUsers <- neg %>%  -->
<!--   group_by(workerid,responseCase,age,education) %>%  -->
<!--   filter(responseCase == "gen") %>%  -->
<!--   group_by(workerid) %>%  -->
<!--   count() -->
<!-- ``` -->

<!-- ```{r} -->
<!-- itkonen <- itkonen %>% -->
<!--   mutate(genUser = case_when( -->
<!--     workerid %in% genUsers$workerid ~ TRUE, -->
<!--     TRUE ~ FALSE -->
<!--   )) -->
<!-- ``` -->


### The Positive-Negative Relationship 

```{r echo=FALSE, message=FALSE}
indiGenRatesPos <- itkonen %>%
  filter(attention=="critical") %>%
  filter(polarity == "positive") %>%
  filter(item != "jokin2") %>%
  mutate(responseBinary = case_when(
    responseCase == "gen" ~ 1,
    responseCase != "gen" ~ 0,
  )) %>%
  group_by(workerid,age,gender) %>%
  summarize(indiGenRatePos = mean(responseBinary)) %>%
  select(c("workerid","indiGenRatePos","age","gender"))
```

```{r echo=FALSE, message=FALSE}
indiNomRatesNeg <- itkonen %>%
  filter(attention=="critical") %>%
  filter(polarity == "negative") %>%
  filter(item != "jokin2") %>%
  mutate(responseBinary = case_when(
    responseCase == "nom" ~ 1,
    responseCase != "nom" ~ 0,
  )) %>%
  group_by(workerid) %>%
  summarize(indiNomRateNeg = mean(responseBinary)) %>%
  select(c("workerid","indiNomRateNeg"))
```

```{r echo=FALSE, message=FALSE}
indiRates <- left_join(indiGenRatesPos,indiNomRatesNeg)
```

As seen in the figure below, our exploratory analysis of the negative data indicates that participants who produced a larger proportion of genitive responses in the positive constructions were less likely to produce nominative under negation. This is a logical finding, as we hypothesized that participants who used less Nominative in positive structures would similarly use it less frequently in negation, if the spread is from nominative in positive to nominative under negation. 

```{r echo=FALSE, message=FALSE, fig.align = 'center'}
indiRates %>%
  ggplot(aes(x=indiGenRatePos,indiNomRateNeg)) +
  geom_point(alpha=0.5) +
  geom_smooth(method = "lm") + 
  geom_hline(yintercept=.5, linetype="dashed", color = "black") + 
  labs(x="Gen. Rate in Positive Constructions",y="Nom. Rate in Negative Constructions")
```




<!-- ```{r} -->
<!-- indiRates %>%  -->
<!--   filter(indiGenRatePos == 0) %>%  -->
<!--   count() -->
<!-- ``` -->

<!-- ```{r} -->
<!-- indiGenRatesPos %>%  -->
<!--   filter(age < 60) %>%  -->
<!--   filter(gender != "Other") %>%  -->
<!--   ggplot(aes(x=age,y=indiGenRatePos,color=gender)) +  -->
<!--   geom_point(alpha=0.5) +  -->
<!--   geom_smooth(method = "lm") -->
<!-- ``` -->

<!-- ```{r} -->
<!-- itkonen %>%  -->
<!--   filter(attention=="critical") %>%  -->
<!--   mutate(responseBinary = case_when( -->
<!--     responseCase == "nom" ~ 1, -->
<!--     responseCase != "nom" ~ 0, -->
<!--   )) %>%  -->
<!--   group_by(genUser) %>%  -->
<!--   summarize( -->
<!--     nomRate = mean(responseBinary), -->
<!--     CI.Low = ci.low(responseBinary), -->
<!--     CI.High = ci.high(responseBinary), -->
<!--   ) %>%  -->
<!--   mutate(YMin = nomRate - CI.Low, YMax = nomRate + CI.High) %>% -->
<!--   ggplot(aes(x=genUser,y=nomRate,fill=genUser)) +  -->
<!--   geom_bar(stat="identity") +  -->
<!--   geom_errorbar(aes(ymin=YMin,ymax=YMax), width=.25) +  -->
<!--   labs(x="Gen User?",y="Proportion of Nom Responses",title="Replication Results: Voice") +  -->
<!--   ylim(0,1) +  -->
<!--   geom_text(aes(x=genUser,y=nomRate, vjust =-1.5, label=trunc(nomRate*10^2)/10^2)) +  -->
<!--   scale_fill_manual(values = type_palette) +  -->
<!--   theme_classic() +  -->
<!--   theme(legend.position = "none") -->
<!-- ``` -->

### Items

We exploratorily found a significant effect of sentence item, such that the sentences with 'harvinainen' and 'valtio' were significantly more likely than any other items to receive Nominative case under negation; interestingly, these are the same items leading the Nominative rate in positive constructions. 

```{r echo=FALSE, fig.align = 'center', message=FALSE}
neg %>% 
  mutate(responseBinary = case_when(
    responseCase == "nom" ~ 1,
    responseCase != "nom" ~ 0,
  )) %>% 
  group_by(item,voice) %>% 
  summarize(
    nomRate = mean(responseBinary),
    CI.Low = ci.low(responseBinary),
    CI.High = ci.high(responseBinary),
  ) %>% 
  mutate(YMin = nomRate - CI.Low, YMax = nomRate + CI.High) %>%
  ggplot(aes(x=reorder(item,-nomRate),y=nomRate, fill=item)) + 
  geom_bar(stat="identity") + 
  geom_errorbar(aes(ymin=YMin,ymax=YMax), width=.25) + 
  geom_hline(yintercept=.5, linetype="dashed", color = "black") + 
  facet_wrap(~voice) + 
  labs(x="Voice",y="Proportion of Nominative Responses",title="Negative Results: Item by Voice") + 
  ylim(0,1) + 
  geom_text(aes(x=item,y=nomRate, vjust =-3, label=trunc(nomRate*10^2)/(10^2))) + 
  scale_fill_brewer(palette="Paired") +
  theme_classic() +
  theme(legend.position = "none") + 
  theme(axis.text.x = element_text(angle=45, vjust=.6))
```

### Region

Coming soon to an analysis near you!

<!-- # ```{r echo=FALSE, fig.align = 'center', message=FALSE} -->
<!-- # neg %>%  -->
<!-- #   mutate(responseBinary = case_when( -->
<!-- #     responseCase == "nom" ~ 1, -->
<!-- #     responseCase != "nom" ~ 0, -->
<!-- #   )) %>%  -->
<!-- #   group_by(region) %>%  -->
<!-- #   summarize( -->
<!-- #     nomRate = mean(responseBinary), -->
<!-- #     CI.Low = ci.low(responseBinary), -->
<!-- #     CI.High = ci.high(responseBinary), -->
<!-- #     count = n() -->
<!-- #   ) %>%  -->
<!-- #   mutate(YMin = nomRate - CI.Low, YMax = nomRate + CI.High) %>% -->
<!-- #   ggplot(aes(x=reorder(region,-nomRate),y=nomRate, fill=region,alpha=count)) +  -->
<!-- #   geom_bar(stat="identity") +  -->
<!-- #   geom_errorbar(aes(ymin=YMin,ymax=YMax), width=.25) +  -->
<!-- #   geom_hline(yintercept=.5, linetype="dashed", color = "black") +  -->
<!-- #   labs(x="Voice",y="Proportion of Nominative Responses",title="Negative Results: Item by Voice") +  -->
<!-- #   ylim(0,1) +  -->
<!-- #   geom_text(aes(x=region,y=nomRate, vjust =-3, label=trunc(nomRate*10^2)/(10^2))) +  -->
<!-- #   # scale_fill_brewer(palette="Paired") + -->
<!-- #   theme_classic() + -->
<!-- #   # theme(legend.position = "none") +  -->
<!-- #   theme(axis.text.x = element_text(angle=45, vjust = .5)) -->
<!-- # ``` -->


# Discussion

## Experiment Part One

Our findings show that there has indeed been an increase in the rate of nominative on embedded objects of Itkonen structures in comparison to the 1976 study, supporting Itkonen’s claim that case assignment in these constructions is undergoing a change from genitive to nominative. Every single item each construction, whether active or passive, or existential or predicative, showed a positive increase in nominative assignment. Several of the items were assigned nominative case one-hundred percent or nearly one-hundred percent of the time, with the lowest rates of nominative assignment always occurring in active existential contexts. Only two items, tulipalo and persikka, were assigned nominative case less than 50% of the time, and that was only in active existential environments.

The fact that active existential constructions were most likely to resist the change to nominative case was predicted by Anttila & Kim (2017), who predicted that passive predicative constructions would be affected most, followed by active predicative constructions, then passive existentials, and finally active existentials. This follows if, as Itkonen (1976) claimed, the change from genitive to nominative preference originated in passive and predicative simplex clauses and was extended to embedded constructions via analogy; active existential constructions share neither the characteristic of being passive nor that of being predicative with the source of the analogy, and thus should be affected last. This claim can be further verified by looking at the data split by voice or by embedded clause type. When divided by voice, embedded objects of passive constructions on average receive nominative cause at a higher rate than in active constructions, and embedded objects of predicative constructions receive nominative case at a higher rate than in existential constructions. Even so, the average rate of nominative case assignment is over 75% in each case. Additionally, Anttila & Kim’s claim that predicative “outweighs” passive, such that active predicatives receive nominative at a higher rate than passive existentials is true for our data as well, which shows the implicational hierarchy of passive predicative >> active predicative >> passive existential >> active existential.

As far as demographic factors are concerned, our data show that nominative case production decreases as a function of age, with younger participants more likely to produce nominative case than older participants. This being said, nearly all participants produce nominative case over 50% of the time, and several assign it 100% of the time. The latter fact correlates nicely with Itkonen’s finding in his original study that there was a group of participants who showed a strong preference for nominative case; the same fact seems to be true now, but the extent of nominative preference has increased for all participants, even those who prefer it the least. 

<!-- There is also a small correlation with education level, with participants who are more highly educated being slightly more likely to produce nominative case than those are less educated. -->

## Experiment Part Two

Given our hypothesis that embedded objects of negated Itkonen structures would only ever be assigned partitive case, the results of part two were quite surprising. Participants did not uniformly produce partitive case, but instead produced nominative case 16% of the time in both active and passive existentials, and produced genitive case 3% and 2% of the time in those two environments, respectively. These data would seem to indicate that the preference for nominative case is spreading not just in constructions where genitive was historically preferred, but may be extending to other environments as well. It is also interesting that there is no difference in the rate of nominative based on matrix voice in negative contexts. One way to interpret this data point is that the spread of nominative in embedded environments has now progressed far enough that it is no longer driven by analogy from simplex clauses, meaning that it will not spread faster in constructions which bear resemblance, either in voice or in embedded clause type, to the simplex clauses in which the change originated.

The fact that genitive case was produced at all is mysterious, as it does not follow either from expectations about partitive case assignment under negation, or from the finding that nominative case is becoming more dominant.

The obvious question that the data on negated structures raise is whether they have potential to bear on existing analyses for the case variation phenomenon. Unfortunately, that is a complex question due to the fact that none of them deal specifically with cross-clausal assignment of partitive case, and hence it is difficult to imagine what predictions they would each make. The minimalist accounts in Vainikka & Brattico (2014) and Ylinärä & Frascarelli (2021), however, would certainly fail to predict the three-way variation observed under negation, as they both propose that case variation results from optionality between two different embedding constructions. If they predict variation under negation, they should predict optionality between two case assignment options, not three. One could also argue that these minimalist accounts are not equipped to explain the manner in which we see nominative preference spreading. There is a group of participants that exclusively produce nominative case in non-negated Itkonen structures, and under a minimalist account this is explained nicely if this group of individuals does not have access to the embedding structure which results in genitive case on the embedded object. Now, extending the principles of the minimalist accounts to the variation we observe under negation, we might like to argue that that variation results in the same way from the availability of those two embedding structures that produced nominative and genitive in non-negated constructions, except that due to the interaction with matrix negation, that manifests as variability between partitive case and nominative case (leaving aside genitive case for the moment). If there is a group of participants that do not have access to one of the embedding structures, we should expect that the same should be true in negative contexts, and that that group of participants should uniformly produce only one of the case options. This, however, is not true; individuals from the exclusively-nominative group in non-negated sentences produce both nominative and partitive case on embedded objects. While perhaps the domain of diachronic syntax would have something to say about this fact, the failure to predict which structures speakers produce in negated constructions based on their preferences in non-negated constructions would seem to be a hurdle for minimalist accounts.

# Conclusion

In summary, our study found that nominative case is produced at higher rate in Itkonen structures than it was in Itkonen’s 1976 experiment. Our data support his prediction that there is a change in progress from a preference for genitive case to a preference for nominative case. The change seems to be progressing rapidly, with nominative case now being assigned over 50% of the time even in active existentials, the environment which is the most resistant to nominative case. Furthermore, our data follow the implicational hierarchy proposed in Anttila & Kim (2017), in which they argue that the change from nominative to genitive is progressing from passive predicatives to active existentials in the following manner: passive predicative >> active predicative >> passive existential >> active existential. The demographic information we collected on our participants showed that younger people produce nominative case more, further supporting the claim that this is a change in progress.

Part two of the study produced the surprising finding that nominative case appears to be spreading in negated Itkonen structures as well, contrary to the expectation that embedded objects in such constructions would exclusively receive partitive case. Previous studies had not predicted that the growing nominative preference would encroach on other cases besides the genitive, and this finding could indicate a more major shift than was previously ever imagined. While one would want to collect more data in a variety of constructions before making any grandiose claims, one could imagine that the growing dominance of unmarked nominative case indicates a language-wide move away from Finnish’s current, complex case-marking system. However, the appearance of genitive case under negation a small, but non-negligible percentage of the time provides an additional, and as-of-yet unexplained complication. Additionally, current accounts of case variation in Finnish are not readily prepared to account for the variation observed in negated contexts, indicating that new accounts which can predict the spread of nominative case throughout the language may be needed.